\documentclass[a4paper, 12pt]{article}
\usepackage{amsmath}
\usepackage{color}
\usepackage{dsfont}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage[left=2cm, right=2cm, bottom=3cm, top=2cm]{geometry}
\usepackage{natbib}
\usepackage{microtype}


\definecolor{orange}{rgb}{1, 0.5, 0}
\definecolor{green}{rgb}{0, 0.5, 0}

\newcommand{\hypers}{\boldsymbol{\alpha}}
\newcommand{\params}{\boldsymbol{\theta}}
\newcommand{\data}{\boldsymbol{x}}
\newcommand{\info}{\boldsymbol{M}}
\newcommand{\x}{x}
\newcommand{\todo}{\color{orange} \bf}


\title{Crystals}
\author{Brendon J. Brewer}
\date{}

\begin{document}
\maketitle

%\abstract{\noindent Abstract}

% Need this after the abstract
\setlength{\parindent}{0pt}
\setlength{\parskip}{8pt}

\section{The prior information}

\subsection{The shape of the model curve}
The function $f(\x)$, defined from $\x_{\rm min}$ to $\x_{\rm max}$,
is assumed to be a sum of the following components:
\begin{enumerate}
\item A background component
\item $N_{\rm wide}$ wide gaussians
\item $N_{\rm narrow}$ narrow gaussians, to model the spikes
\end{enumerate}

The background component is assumed to be linear
{\todo between $x_{\rm min}$ and A, between A and B, and between B
and $x_{\rm max}$}.

\subsection{Prior probability distributions}

The joint prior distribution for the hyperparameters, parameters, and data,
is written $p(\hypers, \params, \data | \info)$, and is usually factorised
in this way:
\begin{align}
p(\hypers, \params, \data | \info) &=
    p(\hypers | \info)p(\params | \hypers, \info)
    p(\data | \params, \hypers, \info)\\
    &= p(\hypers | \info)p(\params | \hypers, \info)
    p(\data | \params, \info)
\end{align}
where the first step is true in general by the product rule, and the second
step assumes that knowing the parameters would make the hyperparameters
irrelevant when predicting what data would be observed.

All of the assumptions are given in Table~\ref{tab:priors}.

\begin{table}
\centering
\begin{tabular}{|lll|}
\hline
{\bf Quantity}      &   {\bf Meaning}   &  {\bf Prior distribution}\\
\hline
{\em Hyperparameters} & &\\
$N_{\rm narrow}$   &   Number of narrow spikes    &  $\propto 1/(N_{\rm narrow}+1)$, $N_{\rm narrow} \in \{0, 1, ..., 300\}$ \\
$N_{\rm wide}$   &   Number of wide spikes    &  $\propto 1/(N_{\rm wide}+1)$,
$N_{\rm wide} \in \{0, 1, ..., 300\}$ \\
\hline
{\em Parameters}& &\\
$\sigma_0$ &    Constant noise level  &   $\ln(\sigma_0) \sim \textnormal{Laplace}(0,5)$\\
$\sigma_1$ &    Noise proportionality   &  $\ln(\sigma_1) \sim \textnormal{Laplace}(0,5)$ \\
$\nu$     &   Shape parameter for residuals   &   LogUniform$(1, 1000)$\\
$b$       & Mean background level       & $\ln(b) \sim$ Laplace$(0, 5)$\\
$\{n_1, ..., n_4\}$  & 
\hline
{\em Data}&&\\
\hline
$\{y_1, y_2, ..., y_n\}$  &   Measurements    & $t(f(x_i; \params), ,\nu)$\\
\hline
{\em Prior information}&&\\
\hline
$n$ & Number of measurements & given\\
$\{x_1, x_2, ..., x_n\}$  & $x$-values of measurements & given \\

\hline
\end{tabular}
\caption{\label{tab:priors}}
\end{table}


The shape of the model function $f(x)$ is therefore
\begin{align}
f(x) &= A + f_{\rm wide}(x) + \sum_{i=1}^N a_i f_i(x)
\end{align}
and the crystallinity is
\begin{align}
C &= \frac{\int f_{\rm wide}(x) \, dx}
          {\int f_{\rm wide}(x) \, dx + \int f_{\rm narrow}(x) \, dx}
\end{align}


\bibliographystyle{plainnat}
\bibliography{references}

\end{document}

